{"version":3,"file":"index.js","sources":["../node_modules/dlib/utils/Loader.js","../src/main/index.js"],"sourcesContent":["let baseURI = \"\";\n\nconst PROMISES = new Map();\nconst OBJECTS = new Map();\n\nconst TYPE_MAP = new Map([\n  [\"text\", new Set([\"txt\", \"html\", \"js\", \"svg\"])],\n  [\"json\", new Set([\"json\"])],\n  [\"binary\", new Set([\"bin\"])],\n  [\"image\", new Set([\"png\", \"jpg\", \"gif\"])],\n  [\"video\", new Set([\"mp4\", \"webm\"])],\n  [\"audio\", new Set([\"mp3\", \"ogg\"])],\n  [\"style\", new Set([\"css\"])],\n  [\"font\", new Set([\"woff\", \"woff2\", \"ttf\"])],\n]);\n\nexport default class Loader {\n  static get onLoad() {\n    return Promise.all(PROMISES.values());\n  }\n\n  static get promises() {\n    return PROMISES;\n  }\n\n  static get typeMap() {\n    return TYPE_MAP;\n  }\n\n  static get(value) {\n    return OBJECTS.get(value);\n  }\n\n  static get baseURI() {\n    return baseURI;\n  }\n\n  static set baseURI(value) {\n    baseURI = value;\n  }\n\n  static load(values) {\n    const returnArray = values instanceof Array;\n    \n    if(!returnArray) {\n      values = [values];\n    }\n\n    let promises = [];\n\n    for (let value of values) {\n      if(!value) {\n        continue;\n      }\n\n      let type;\n      if(typeof value === \"object\") {\n        type = value.type;\n        value = value.value;\n      }\n\n      const src = `${baseURI}${typeof value === \"string\" ? value : (value.href || value.src)}`;\n      const extension = /[\\\\/](.*)\\.(.*)$/.exec(src)[2];\n\n      if(!type) {\n        for (const [key, value] of TYPE_MAP) {\n          if(value.has(extension)) {\n            type = key;\n            break;\n          }\n        }\n      }\n\n      let promise = new Promise(function(resolve, reject) {\n        if(PROMISES.get(value)) {\n          PROMISES.get(value).then(resolve);\n          return;\n        }\n        \n        if(Loader.get(value)) {\n          resolve(Loader.get(value));\n          return;\n        }\n\n        fetch(`${baseURI}${src}`)\n        .catch(() => {\n          return new Promise(function(resolve, reject) {\n            const xhr = new XMLHttpRequest\n            xhr.onload = function() {\n              resolve(new Response(xhr.responseText, {status: xhr.status}))\n            }\n            xhr.open(\"GET\", `${baseURI}${src}`)\n            xhr.send(null)\n          })\n        })\n        .then((response) => {\n          if(type === \"text\") {\n            return response.text();\n          } else if(type === \"json\") {\n            return response.json();\n          } else if(type === \"binary\") {\n            return response.arrayBuffer();\n          } else if(type === \"image\") {\n            return new Promise((resolve) => {\n              const image = document.createElement(\"img\");\n              image.onload = () => { resolve(image); }\n              image.src = src;\n            });\n          } else if(type === \"video\" || type === \"audio\") {\n            return new Promise((resolve) => {\n              const media = document.createElement(type);\n              media.oncanplaythrough = () => { resolve(media); }\n              media.src = src;\n            });\n          } else if(type === \"style\") {\n            return new Promise((resolve) => {\n              const link = document.createElement(\"link\");\n              link.rel = \"stylesheet\";\n              link.type = \"text/css\";\n              link.onload = () => { resolve(link); }\n              document.head.appendChild(link);\n              link.href = src;\n            });\n          } else if(type === \"font\") {\n            return new Promise((resolve) => {\n              let fontFace = new FontFace(/([^\\/]*)\\.(woff|woff2|ttf)$/.exec(value)[1], `url(\"${value}\")`);\n              document.fonts.add(fontFace);\n              return fontFace.load();\n            });\n          } else if(type === \"template\") {\n            return response.text().then((html) => {\n              const template = document.createElement(\"template\");\n              template.innerHTML = html;\n              return template;\n            });\n          } else {\n            return response.blob();\n          }\n        })\n        .then((response) => {\n          PROMISES.delete(value);\n          OBJECTS.set(value, response);\n          resolve(response);\n        });\n      });\n\n      promises.push(promise);\n      PROMISES.set(value, promise);\n    }\n\n    return returnArray ? Promise.all(promises) : promises[0];\n  }\n}\n","import Loader from \"../../node_modules/dlib/utils/Loader.js\";\r\n\r\nconst LOAD_PROMISE = Promise.all([\r\n  Loader.load({ value: \"src/main/template.html\", type: \"template\" }),\r\n  Loader.load(\"src/main/index.css\")\r\n]);\r\n\r\nwindow.customElements.define(\"dnit-main\", class extends HTMLElement {\r\n  connectedCallback() {\r\n    LOAD_PROMISE.then(([template]) => {\r\n      let templateClone = document.importNode(template.content, true);\r\n      this.appendChild(templateClone);\r\n    });\r\n  }\r\n});\r\n"],"names":[],"mappings":"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"}